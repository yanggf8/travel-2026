{
  "$schema": "./schemas/ota-sources.schema.json",
  "version": "1.0.0",
  "sources": {
    "besttour": {
      "source_id": "besttour",
      "display_name": "喜鴻假期",
      "display_name_en": "Best Tour",
      "types": ["package"],
      "base_url": "https://www.besttour.com.tw",
      "markets": ["TW"],
      "currency": "TWD",
      "supported": true,
      "scraper_script": "scripts/scrape_package.py",
      "search_url_templates": {
        "listing": "/e_web/activity?v={region_slug}",
        "product": "/itinerary/{product_code}"
      },
      "region_slugs": {
        "tokyo": "japan_tokyo",
        "kansai": "japan_kansai",
        "hokkaido": "japan_hokkaido",
        "kyushu": "japan_kyushu",
        "okinawa": "japan_okinawa"
      },
      "rate_limit": {
        "requests_per_minute": 10
      },
      "notes": "Use listing URL for search, NOT /e_web/DOM/ (returns 404)"
    },
    "liontravel": {
      "source_id": "liontravel",
      "display_name": "雄獅旅遊",
      "display_name_en": "Lion Travel",
      "types": ["package", "flight", "hotel"],
      "base_url": "https://www.liontravel.com",
      "markets": ["TW"],
      "currency": "TWD",
      "supported": true,
      "scraper_script": "scripts/scrape_liontravel_dated.py",
      "search_url_templates": {
        "fit": "https://vacation.liontravel.com/search?Destination={dest_code}&FromDate={from_yyyymmdd}&ToDate={to_yyyymmdd}&Days={days}&roomlist={adults}-0-0",
        "group": null
      },
      "destination_codes": {
        "tokyo_5d": "JP_TYO_5",
        "tokyo_6d": "JP_TYO_6",
        "osaka_5d": "JP_OSA_5",
        "osaka_6d": "JP_OSA_6",
        "hokkaido_5d": "JP_CTS_5",
        "okinawa_4d": "JP_OKA_4"
      },
      "rate_limit": {
        "requests_per_minute": 5
      },
      "limitations": [
        "fit_only_no_group_tour",
        "requires_specific_dest_code"
      ],
      "price_factors": [
        "holiday_departure_premium",
        "weekday_vs_weekend_pricing",
        "date_specific_pricing_varies_dramatically"
      ],
      "promo_codes": [
        {
          "code": "FITPKG",
          "discount": 400,
          "currency": "TWD",
          "min_purchase": 20000,
          "valid_days": ["Thursday"],
          "expires": null
        }
      ],
      "notes": "FIT search via vacation.liontravel.com, group tour URL unknown"
    },
    "tigerair": {
      "source_id": "tigerair",
      "display_name": "台灣虎航",
      "display_name_en": "Tigerair Taiwan",
      "types": ["flight"],
      "base_url": "https://www.tigerairtw.com",
      "markets": ["TW"],
      "currency": "TWD",
      "supported": true,
      "scraper_script": null,
      "rate_limit": {
        "requests_per_minute": 10
      },
      "notes": "Limited - no date-specific pricing via scraper"
    },
    "lifetour": {
      "source_id": "lifetour",
      "display_name": "五福旅遊",
      "display_name_en": "Lifetour",
      "types": ["package", "flight", "hotel"],
      "base_url": "https://tour.lifetour.com.tw",
      "markets": ["TW"],
      "currency": "TWD",
      "supported": true,
      "scraper_script": "scripts/scrape_package.py",
      "search_url_templates": {
        "group_tour": "https://tour.lifetour.com.tw/searchlist/{departure}/{region_code}",
        "product": "https://tour.lifetour.com.tw/detail*"
      },
      "departures": {
        "taipei": "tpe",
        "taichung": "txg",
        "kaohsiung": "khh"
      },
      "region_codes": {
        "tokyo": "0001-0001",
        "kansai": "0001-0003",
        "hokkaido": "0001-0002",
        "kyushu": "0001-0004",
        "okinawa": "0001-0005"
      },
      "rate_limit": {
        "requests_per_minute": 5
      },
      "notes": "Group tour listing at tour.lifetour.com.tw/searchlist/{departure}/{region}"
    },
    "settour": {
      "source_id": "settour",
      "display_name": "東南旅遊",
      "display_name_en": "Southeast Travel",
      "types": ["package", "flight", "hotel"],
      "base_url": "https://www.settour.com.tw",
      "markets": ["TW"],
      "currency": "TWD",
      "supported": true,
      "scraper_script": "scripts/scrape_package.py",
      "search_url_templates": {
        "group_tour": "https://tour.settour.com.tw/search?destinationCode={dest_code}",
        "fit": "https://fit.settour.com.tw/tour/product/*",
        "product": "https://tour.settour.com.tw/product/*"
      },
      "destination_codes": {
        "tokyo": "JX_1",
        "kansai": "JX_3",
        "hokkaido": "JX_2",
        "kyushu": "JX_4",
        "okinawa": "JX_5"
      },
      "rate_limit": {
        "requests_per_minute": 5
      },
      "notes": "Group tour search at tour.settour.com.tw/search?destinationCode={code}"
    },
    "eztravel": {
      "source_id": "eztravel",
      "display_name": "易遊網",
      "display_name_en": "ezTravel",
      "types": ["package", "flight", "hotel"],
      "base_url": "https://www.eztravel.com.tw",
      "markets": ["TW"],
      "currency": "TWD",
      "supported": false,
      "scraper_script": null,
      "notes": "Scraper not yet implemented"
    },
    "jalan": {
      "source_id": "jalan",
      "display_name": "じゃらん",
      "display_name_en": "Jalan",
      "types": ["hotel"],
      "base_url": "https://www.jalan.net",
      "markets": ["JP"],
      "currency": "JPY",
      "supported": false,
      "scraper_script": null,
      "notes": "Japan domestic OTA - for local hotel bookings"
    },
    "rakuten_travel": {
      "source_id": "rakuten_travel",
      "display_name": "楽天トラベル",
      "display_name_en": "Rakuten Travel",
      "types": ["hotel", "package"],
      "base_url": "https://travel.rakuten.co.jp",
      "markets": ["JP"],
      "currency": "JPY",
      "supported": false,
      "scraper_script": null,
      "notes": "Japan domestic OTA"
    },
    "trip": {
      "source_id": "trip",
      "display_name": "Trip.com",
      "display_name_en": "Trip.com",
      "types": ["flight"],
      "base_url": "https://www.trip.com",
      "markets": ["TW", "JP", "INTL"],
      "currency": "USD",
      "supported": false,
      "scraper_script": "scripts/scrape_package.py",
      "search_url_templates": {
        "flight_roundtrip": "https://www.trip.com/flights/{origin}-to-{dest}/tickets-{origin_code}-{dest_code}?dcity={origin_code}&acity={dest_code}&ddate={depart_date}&rdate={return_date}&flighttype=rt&class=y&quantity={pax}",
        "flight_oneway": "https://www.trip.com/flights/{origin}-to-{dest}/tickets-{origin_code}-{dest_code}?dcity={origin_code}&acity={dest_code}&ddate={depart_date}&flighttype=ow&class=y&quantity={pax}",
        "hotel": "https://www.trip.com/hotels/{city}-hotel-detail-{hotel_id}/?checkIn={checkin}&checkOut={checkout}&adult={adults}"
      },
      "rate_limit": {
        "requests_per_minute": 5
      },
      "limitations": [
        "no_flight_numbers_in_search",
        "hotel_requires_login",
        "roundtrip_shows_outbound_only"
      ],
      "price_factors": [
        "return_day_affects_price",
        "lcc_baggage_not_included"
      ],
      "notes": "Flight search works via Playwright. Hotel details require login. Roundtrip search only shows outbound - scrape return as separate one-way. Prices in USD, convert to TWD (~32)."
    },
    "booking": {
      "source_id": "booking",
      "display_name": "Booking.com",
      "display_name_en": "Booking.com",
      "types": ["hotel"],
      "base_url": "https://www.booking.com",
      "markets": ["TW", "JP", "INTL"],
      "currency": "TWD",
      "supported": false,
      "scraper_script": "scripts/scrape_package.py",
      "search_url_templates": {
        "search": "https://www.booking.com/searchresults.{lang}.html?dest_id={dest_id}&dest_type=city&checkin={checkin}&checkout={checkout}&group_adults={adults}&no_rooms={rooms}&selected_currency={currency}",
        "hotel": "https://www.booking.com/hotel/{country}/{hotel_slug}.{lang}.html?checkin={checkin}&checkout={checkout}"
      },
      "destination_ids": {
        "osaka": "-240905",
        "tokyo": "-246227",
        "kyoto": "-235402"
      },
      "rate_limit": {
        "requests_per_minute": 3
      },
      "limitations": [
        "cloudflare_protection",
        "search_may_need_retry",
        "requires_dest_id_parameter"
      ],
      "price_factors": [
        "price_per_night_not_total",
        "taxes_may_be_separate"
      ],
      "notes": "Cloudflare bot protection. Use lang=zh-tw for Traditional Chinese. Initial search may not load results - retry or use direct hotel URL. Prices shown per night."
    },
    "agoda": {
      "source_id": "agoda",
      "display_name": "Agoda",
      "display_name_en": "Agoda",
      "types": ["hotel"],
      "base_url": "https://www.agoda.com",
      "markets": ["TW", "JP", "INTL"],
      "currency": "TWD",
      "supported": false,
      "scraper_script": null,
      "notes": "Bot detection - search often redirects to wrong location. Not recommended for scraping."
    },
    "skyscanner": {
      "source_id": "skyscanner",
      "display_name": "Skyscanner",
      "display_name_en": "Skyscanner",
      "types": ["flight"],
      "base_url": "https://www.skyscanner.com.tw",
      "markets": ["TW", "INTL"],
      "currency": "TWD",
      "supported": false,
      "scraper_script": null,
      "notes": "Strong bot detection - returns 'Are you a robot?' page. Not scrapable."
    },
    "google_flights": {
      "source_id": "google_flights",
      "display_name": "Google Flights",
      "display_name_en": "Google Flights",
      "types": ["flight"],
      "base_url": "https://www.google.com/travel/flights",
      "markets": ["INTL"],
      "currency": "TWD",
      "supported": false,
      "scraper_script": null,
      "notes": "Heavy JS rendering - search results don't load via Playwright. Use for manual price verification only."
    }
  }
}
